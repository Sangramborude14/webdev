<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Master - Clock, Stopwatch, Timer & Alarm</title>
    <!-- We're using Tailwind CSS for easy, modern styling without a separate CSS file -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons for nice UI elements -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom styles for smoother transitions */
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        body {
            transition: background-color 0.5s ease;
        }
        /* Style for the active tab button */
        .tab-btn.active {
            border-bottom: 3px solid #3b82f6;
            color: #3b82f6;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <!-- Main Container -->
    <div class="glass-effect w-full max-w-md rounded-3xl shadow-2xl overflow-hidden border border-white">
        
        <!-- Header / Navigation -->
        <nav class="flex justify-around border-b border-slate-200 bg-white">
            <button onclick="showTab('clock')" id="btn-clock" class="tab-btn active flex flex-col items-center py-4 px-2 w-full transition-all hover:bg-slate-50">
                <i data-lucide="clock" class="w-6 h-6 mb-1"></i>
                <span class="text-xs font-semibold">Clock</span>
            </button>
            <button onclick="showTab('stopwatch')" id="btn-stopwatch" class="tab-btn flex flex-col items-center py-4 px-2 w-full transition-all hover:bg-slate-50">
                <i data-lucide="timer" class="w-6 h-6 mb-1"></i>
                <span class="text-xs font-semibold">Stopwatch</span>
            </button>
            <button onclick="showTab('timer')" id="btn-timer" class="tab-btn flex flex-col items-center py-4 px-2 w-full transition-all hover:bg-slate-50">
                <i data-lucide="hourglass" class="w-6 h-6 mb-1"></i>
                <span class="text-xs font-semibold">Timer</span>
            </button>
            <button onclick="showTab('alarm')" id="btn-alarm" class="tab-btn flex flex-col items-center py-4 px-2 w-full transition-all hover:bg-slate-50">
                <i data-lucide="alarm-clock" class="w-6 h-6 mb-1"></i>
                <span class="text-xs font-semibold">Alarm</span>
            </button>
        </nav>

        <!-- Content Area -->
        <div class="p-8 min-h-[400px]">

            <!-- 1. WORLD CLOCK SECTION -->
            <div id="clock" class="tab-content active text-center">
                <h2 class="text-slate-400 font-medium tracking-widest uppercase text-sm mb-4">Current Time</h2>
                <div id="display-clock" class="text-6xl font-bold text-slate-800 mb-2">00:00:00</div>
                <div id="display-date" class="text-slate-500 font-medium">Monday, Jan 1, 2024</div>
            </div>

            <!-- 2. STOPWATCH SECTION -->
            <div id="stopwatch" class="tab-content text-center">
                <h2 class="text-slate-400 font-medium tracking-widest uppercase text-sm mb-4">Stopwatch</h2>
                <div id="display-stopwatch" class="text-6xl font-mono font-bold text-slate-800 mb-8 tracking-tighter">00:00.00</div>
                
                <div class="flex justify-center gap-4">
                    <button id="sw-start" onclick="startStopwatch()" class="bg-blue-600 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-blue-700 active:scale-95 transition-all">Start</button>
                    <button id="sw-stop" onclick="stopStopwatch()" class="bg-red-500 text-white px-8 py-3 rounded-full font-bold shadow-lg hidden hover:bg-red-600 active:scale-95 transition-all">Stop</button>
                    <button onclick="resetStopwatch()" class="bg-slate-200 text-slate-700 px-8 py-3 rounded-full font-bold hover:bg-slate-300 active:scale-95 transition-all">Reset</button>
                </div>
            </div>

            <!-- 3. TIMER SECTION -->
            <div id="timer" class="tab-content text-center">
                <h2 class="text-slate-400 font-medium tracking-widest uppercase text-sm mb-4">Countdown Timer</h2>
                
                <!-- Inputs for setting time -->
                <div id="timer-setup" class="flex justify-center gap-2 mb-8">
                    <div class="flex flex-col">
                        <input type="number" id="t-min" placeholder="MM" min="0" max="99" class="w-20 text-3xl p-3 border rounded-xl text-center focus:ring-2 focus:ring-blue-400 outline-none">
                        <span class="text-xs text-slate-400 mt-1 uppercase font-bold">Min</span>
                    </div>
                    <div class="text-3xl pt-3 text-slate-300">:</div>
                    <div class="flex flex-col">
                        <input type="number" id="t-sec" placeholder="SS" min="0" max="59" class="w-20 text-3xl p-3 border rounded-xl text-center focus:ring-2 focus:ring-blue-400 outline-none">
                        <span class="text-xs text-slate-400 mt-1 uppercase font-bold">Sec</span>
                    </div>
                </div>

                <!-- Live countdown display (hidden until started) -->
                <div id="timer-running" class="hidden">
                    <div id="display-timer" class="text-7xl font-bold text-slate-800 mb-8">00:00</div>
                </div>

                <div class="flex justify-center gap-4">
                    <button id="timer-start-btn" onclick="startTimer()" class="bg-blue-600 text-white px-10 py-3 rounded-full font-bold shadow-lg hover:bg-blue-700 active:scale-95 transition-all">Start</button>
                    <button id="timer-cancel-btn" onclick="cancelTimer()" class="bg-slate-200 text-slate-700 px-10 py-3 rounded-full font-bold hidden hover:bg-slate-300 active:scale-95 transition-all">Cancel</button>
                </div>
            </div>

            <!-- 4. ALARM SECTION -->
            <div id="alarm" class="tab-content text-center">
                <h2 class="text-slate-400 font-medium tracking-widest uppercase text-sm mb-4">Set Alarm</h2>
                
                <div class="flex flex-col items-center gap-4 mb-6">
                    <input type="time" id="alarm-time" class="text-4xl p-4 border-2 border-slate-100 rounded-2xl bg-white shadow-inner outline-none focus:border-blue-400 transition-all">
                    
                    <button onclick="setAlarm()" class="bg-blue-600 text-white w-full py-4 rounded-2xl font-bold shadow-lg hover:bg-blue-700 active:scale-95 transition-all">
                        Set New Alarm
                    </button>
                </div>

                <div id="alarm-list" class="text-left space-y-2 max-h-48 overflow-y-auto pr-1">
                    <!-- Alarms will appear here -->
                    <p class="text-slate-400 text-sm text-center italic">No alarms set yet</p>
                </div>
            </div>

        </div>

        <!-- Notification Bar (Hidden by default) -->
        <div id="notification" class="hidden bg-yellow-400 p-4 text-center font-bold text-yellow-900 animate-pulse">
            <span id="notification-msg">TIME'S UP!</span>
            <button onclick="dismissNotification()" class="ml-4 underline">Dismiss</button>
        </div>
    </div>

    <!-- Audio for Alarm/Timer - Using a standard beep sound -->
    <audio id="beep-sound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // --- GLOBAL VARIABLES ---
        let currentTab = 'clock';
        const beep = document.getElementById('beep-sound');

        // --- NAVIGATION LOGIC ---
        function showTab(tabId) {
            // Hide all contents
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            // Deactivate all buttons
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            
            // Show selected
            document.getElementById(tabId).classList.add('active');
            document.getElementById('btn-' + tabId).classList.add('active');
            currentTab = tabId;
        }

        // --- 1. CLOCK LOGIC ---
        function updateClock() {
            const now = new Date();
            
            // Format Time
            const timeStr = now.toLocaleTimeString('en-US', { 
                hour12: false, 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            });
            document.getElementById('display-clock').textContent = timeStr;
            
            // Format Date
            const dateStr = now.toLocaleDateString('en-US', { 
                weekday: 'long', 
                month: 'short', 
                day: 'numeric', 
                year: 'numeric' 
            });
            document.getElementById('display-date').textContent = dateStr;

            // Check Alarms every second
            checkAlarms(timeStr.substring(0, 5)); // Passing "HH:MM"
        }
        setInterval(updateClock, 1000);
        updateClock(); // Initial call

        // --- 2. STOPWATCH LOGIC ---
        let swInterval;
        let swStartTime;
        let swElapsedTime = 0;

        function startStopwatch() {
            swStartTime = Date.now() - swElapsedTime;
            swInterval = setInterval(() => {
                swElapsedTime = Date.now() - swStartTime;
                updateStopwatchDisplay();
            }, 10);
            
            document.getElementById('sw-start').classList.add('hidden');
            document.getElementById('sw-stop').classList.remove('hidden');
        }

        function stopStopwatch() {
            clearInterval(swInterval);
            document.getElementById('sw-start').classList.remove('hidden');
            document.getElementById('sw-stop').classList.add('hidden');
        }

        function resetStopwatch() {
            stopStopwatch();
            swElapsedTime = 0;
            updateStopwatchDisplay();
        }

        function updateStopwatchDisplay() {
            let totalMs = swElapsedTime;
            let mins = Math.floor(totalMs / 60000);
            let secs = Math.floor((totalMs % 60000) / 1000);
            let ms = Math.floor((totalMs % 1000) / 10);

            let display = 
                String(mins).padStart(2, '0') + ":" + 
                String(secs).padStart(2, '0') + "." + 
                String(ms).padStart(2, '0');
            
            document.getElementById('display-stopwatch').textContent = display;
        }

        // --- 3. TIMER LOGIC ---
        let timerInterval;
        let timerSecondsRemaining = 0;

        function startTimer() {
            const minsInput = parseInt(document.getElementById('t-min').value) || 0;
            const secsInput = parseInt(document.getElementById('t-sec').value) || 0;
            
            timerSecondsRemaining = (minsInput * 60) + secsInput;

            if (timerSecondsRemaining <= 0) return;

            // UI Switch
            document.getElementById('timer-setup').classList.add('hidden');
            document.getElementById('timer-running').classList.remove('hidden');
            document.getElementById('timer-start-btn').classList.add('hidden');
            document.getElementById('timer-cancel-btn').classList.remove('hidden');

            updateTimerDisplay();

            timerInterval = setInterval(() => {
                timerSecondsRemaining--;
                updateTimerDisplay();

                if (timerSecondsRemaining <= 0) {
                    clearInterval(timerInterval);
                    triggerAlert("Timer Finished!");
                    cancelTimer();
                }
            }, 1000);
        }

        function cancelTimer() {
            clearInterval(timerInterval);
            document.getElementById('timer-setup').classList.remove('hidden');
            document.getElementById('timer-running').classList.add('hidden');
            document.getElementById('timer-start-btn').classList.remove('hidden');
            document.getElementById('timer-cancel-btn').classList.add('hidden');
            document.getElementById('t-min').value = "";
            document.getElementById('t-sec').value = "";
        }

        function updateTimerDisplay() {
            const m = Math.floor(timerSecondsRemaining / 60);
            const s = timerSecondsRemaining % 60;
            document.getElementById('display-timer').textContent = 
                String(m).padStart(2, '0') + ":" + String(s).padStart(2, '0');
        }

        // --- 4. ALARM LOGIC ---
        let alarms = [];

        function setAlarm() {
            const alarmTime = document.getElementById('alarm-time').value;
            if (!alarmTime) return;

            // Check if already exists
            if (alarms.includes(alarmTime)) return;

            alarms.push(alarmTime);
            renderAlarms();
        }

        function renderAlarms() {
            const list = document.getElementById('alarm-list');
            if (alarms.length === 0) {
                list.innerHTML = `<p class="text-slate-400 text-sm text-center italic">No alarms set yet</p>`;
                return;
            }

            list.innerHTML = "";
            alarms.sort().forEach((time, index) => {
                const item = document.createElement('div');
                item.className = "flex justify-between items-center bg-slate-50 p-3 rounded-xl border border-slate-100";
                item.innerHTML = `
                    <span class="font-bold text-slate-700 text-lg">${time}</span>
                    <button onclick="removeAlarm(${index})" class="text-red-400 hover:text-red-600 p-1">
                        <i data-lucide="trash-2" class="w-5 h-5"></i>
                    </button>
                `;
                list.appendChild(item);
            });
            lucide.createIcons();
        }

        function removeAlarm(index) {
            alarms.splice(index, 1);
            renderAlarms();
        }

        function checkAlarms(currentTimeStr) {
            if (alarms.includes(currentTimeStr)) {
                triggerAlert(`Alarm ringing: ${currentTimeStr}`);
                // Remove alarm after it rings so it doesn't repeat every second of that minute
                alarms = alarms.filter(a => a !== currentTimeStr);
                renderAlarms();
            }
        }

        // --- SHARED NOTIFICATION SYSTEM ---
        function triggerAlert(msg) {
            const note = document.getElementById('notification');
            const noteMsg = document.getElementById('notification-msg');
            noteMsg.textContent = msg;
            note.classList.remove('hidden');
            
            // Loop sound
            beep.loop = true;
            beep.play();
        }

        function dismissNotification() {
            document.getElementById('notification').classList.add('hidden');
            beep.pause();
            beep.currentTime = 0;
        }

    </script>
</body>
</html>